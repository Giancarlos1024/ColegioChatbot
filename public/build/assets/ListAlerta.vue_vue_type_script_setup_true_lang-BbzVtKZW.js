import{s as p}from"./index-CIJ9kEDP.js";import{s as I,a as n}from"./index-8c4t-1rM.js";import{s as T}from"./index-DWx6GgBR.js";import{s as B,a as E}from"./index-CqE_d7Eh.js";import{d as N,aa as S,r,B as y,a2 as z,o as M,c as O,a as j,F as G,b as a,f as l,w as u,i as H,t as K,g as c}from"./app-CSI2DTQR.js";import{l as q}from"./lodash-B3zt2wbW.js";import{_ as J}from"./DeleteAlerta.vue_vue_type_script_setup_true_lang-B2G4-lLf.js";import{_ as Q}from"./UpdateAlerta.vue_vue_type_script_setup_true_lang-Bj9NQsP6.js";import{s as W}from"./index-Bd8tXdo1.js";const X={class:"flex flex-col md:flex-row flex-wrap gap-2 items-start md:items-center justify-between"},Y={class:"flex flex-col items-end gap-2 w-full md:w-auto"},Z={class:"flex flex-row gap-2"},ee={class:"flex flex-row gap-2"},ue=N({__name:"ListAlerta",props:{refresh:{}},setup(x){const k=x,A=S(),_=r(null),w=r([]),b=r([]),d=r(null),m=r(!1),f=r(""),v=r(!1),g=r(!1),h=r(null),P=r(null),$=r(1),s=r({currentPage:1,perPage:15,total:0});y(()=>k.refresh,()=>i()),y(()=>d.value,()=>{$.value=1,i()});function C(o){P.value=o.id,g.value=!0}function V(o){h.value=o,v.value=!0}function D(){i()}function L(){i()}const i=async()=>{m.value=!0;try{const o={page:s.value.currentPage,per_page:s.value.perPage,search:f.value,fecha:d.value?d.value.toISOString().slice(0,10):""},e=await z.get("/alerta",{params:o});w.value=e.data.data,s.value.currentPage=e.data.meta.current_page,s.value.total=e.data.meta.total}catch(o){console.error("Error al cargar alertas:",o),A.add({severity:"error",summary:"Error",detail:"No se pudieron cargar las alertas",life:3e3})}finally{m.value=!1}},F=o=>{s.value.currentPage=o.page+1,s.value.perPage=o.rows,i()},R=q.debounce(()=>{s.value.currentPage=1,i()},500);return M(()=>i()),(o,e)=>(j(),O(G,null,[a(l(I),{ref_key:"dt",ref:_,selection:b.value,"onUpdate:selection":e[3]||(e[3]=t=>b.value=t),value:w.value,dataKey:"id",paginator:!0,rows:s.value.perPage,totalRecords:s.value.total,loading:m.value,lazy:!0,onPage:F,rowsPerPageOptions:[15,20,25],scrollable:"",scrollHeight:"574px",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} alertas",class:"w-full"},{header:u(()=>[c("div",X,[e[7]||(e[7]=c("h4",{class:"m-0"},"ALERTAS",-1)),c("div",Y,[c("div",Z,[a(l(W),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),dateFormat:"yy-mm-dd",placeholder:"Filtrar por fecha",class:"w-full md:w-auto"},null,8,["modelValue"]),a(l(p),{icon:"pi pi-times",outlined:"",rounded:"",class:"w-full md:w-auto",onClick:e[1]||(e[1]=t=>d.value=null)})]),c("div",ee,[a(l(B),{class:"w-full md:w-auto"},{default:u(()=>[a(l(E),null,{default:u(()=>[...e[6]||(e[6]=[c("i",{class:"pi pi-search"},null,-1)])]),_:1}),a(l(T),{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),onInput:l(R),placeholder:"Buscar por título o descripción...",class:"w-full md:w-80"},null,8,["modelValue","onInput"])]),_:1}),a(l(p),{icon:"pi pi-refresh",outlined:"",rounded:"",class:"w-full md:w-auto",onClick:i})])])])]),default:u(()=>[a(l(n),{selectionMode:"multiple",style:{width:"1rem"}}),a(l(n),{field:"titulo",header:"Título",sortable:"",style:{"min-width":"12rem"}},{body:u(({data:t})=>[H(K(t.titulo||"-"),1)]),_:1}),a(l(n),{field:"descripcion",header:"Descripción",sortable:"",style:{"min-width":"12rem"}}),a(l(n),{field:"fecha",header:"Fecha",sortable:"",style:{"min-width":"10rem"}}),a(l(n),{field:"creacion",header:"Creación",sortable:"",style:{"min-width":"13rem"}}),a(l(n),{field:"actualizacion",header:"Actualización",sortable:"",style:{"min-width":"13rem"}}),a(l(n),{field:"acciones",header:"Acciones",exportable:!1,style:{"min-width":"10rem"}},{body:u(({data:t})=>[a(l(p),{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2 mb-2 md:mb-0",onClick:U=>C(t)},null,8,["onClick"]),a(l(p),{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",class:"mb-2 md:mb-0",onClick:U=>V(t)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","rows","totalRecords","loading"]),a(J,{visible:v.value,"onUpdate:visible":e[4]||(e[4]=t=>v.value=t),alerta:h.value,onDeleted:D},null,8,["visible","alerta"]),a(Q,{visible:g.value,"onUpdate:visible":e[5]||(e[5]=t=>g.value=t),alertaId:P.value,onUpdated:L},null,8,["visible","alertaId"])],64))}});export{ue as _};
