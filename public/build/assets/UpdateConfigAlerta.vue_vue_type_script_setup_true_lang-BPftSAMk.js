import{s as z}from"./index-Bd5u6C13.js";import{s as b}from"./index-C4jvCa1H.js";import{s as x}from"./index-CIJ9kEDP.js";import{d as I,aa as j,r as n,B as y,a2 as w,e as D,a as f,w as C,g as l,b as c,c as A,j as _,i as V,f as d,n as k,t as E}from"./app-CSI2DTQR.js";const G={class:"flex flex-col gap-6"},T={class:"grid grid-cols-12 gap-4"},S={class:"col-span-12 md:col-span-6"},F={key:0,class:"text-red-500"},R={class:"col-span-12 md:col-span-6"},W={key:0,class:"text-red-500"},q={class:"flex flex-col sm:flex-row gap-2 w-full sm:justify-end"},M=I({__name:"UpdateConfigAlerta",props:{visible:{type:Boolean},configAlertaId:{}},emits:["update:visible","updated"],setup(N,{emit:h}){const r=N,v=h,u=j(),i=n(r.visible),m=n(!1),B=n(!1),t=n({}),o=n({time:0,amount:0});y(()=>r.visible,a=>{i.value=a,a&&r.configAlertaId&&U()}),y(i,a=>v("update:visible",a));const U=async()=>{try{m.value=!0;const e=(await w.get(`/config_alerta/${r.configAlertaId}`)).data.configAlert;o.value={time:Number(e.time),amount:Number(e.amount)}}catch(a){u.add({severity:"error",summary:"Error",detail:"No se pudo cargar la configuración de alerta",life:3e3}),console.error(a)}finally{m.value=!1}},$=async()=>{var a;B.value=!0,t.value={};try{const e={time:o.value.time,amount:o.value.amount};await w.put(`/config_alerta/${r.configAlertaId}`,e),u.add({severity:"success",summary:"Actualizado",detail:"Configuración de alerta actualizada correctamente",life:3e3}),i.value=!1,v("updated")}catch(e){const s=e;s.response&&((a=s.response.data)!=null&&a.errors)?(t.value=s.response.data.errors,u.add({severity:"error",summary:"Error de validación",detail:"Revisa los campos e intenta nuevamente.",life:5e3})):u.add({severity:"error",summary:"Error",detail:"No se pudo actualizar la configuración de alerta",life:3e3}),console.error(e)}};return(a,e)=>(f(),D(d(z),{visible:i.value,"onUpdate:visible":e[3]||(e[3]=s=>i.value=s),header:"Editar Configuración de Alerta",modal:"",closable:!0,style:{width:"95vw",maxWidth:"500px"}},{footer:C(()=>[l("div",q,[c(d(x),{label:"Cancelar",icon:"pi pi-times",text:"",class:"w-full sm:w-auto",onClick:e[2]||(e[2]=s=>i.value=!1)}),c(d(x),{label:"Guardar",icon:"pi pi-check",onClick:$,loading:m.value,class:"w-full sm:w-auto"},null,8,["loading"])])]),default:C(()=>{var s,g;return[l("div",G,[l("div",T,[l("div",S,[e[4]||(e[4]=l("label",{class:"block font-bold mb-2"},[V("Cantidad "),l("span",{class:"text-red-500"},"*")],-1)),c(d(b),{modelValue:o.value.amount,"onUpdate:modelValue":e[0]||(e[0]=p=>o.value.amount=p),min:0,useGrouping:!1,inputClass:"w-full",class:k({"p-invalid":t.value.amount})},null,8,["modelValue","class"]),t.value.amount?(f(),A("small",F,E((s=t.value.amount)==null?void 0:s[0]),1)):_("",!0)]),l("div",R,[e[5]||(e[5]=l("label",{class:"block font-bold mb-2"},[V("Tiempo "),l("span",{class:"text-red-500"},"*")],-1)),c(d(b),{modelValue:o.value.time,"onUpdate:modelValue":e[1]||(e[1]=p=>o.value.time=p),mode:"decimal",locale:"en-US",min:0,maxFractionDigits:2,step:.1,useGrouping:!1,inputClass:"w-full",class:k({"p-invalid":t.value.time}),placeholder:"Ej: 5.5 (h/m/s)"},null,8,["modelValue","class"]),t.value.time?(f(),A("small",W,E((g=t.value.time)==null?void 0:g[0]),1)):_("",!0)])])])]}),_:1},8,["visible"]))}});export{M as _};
