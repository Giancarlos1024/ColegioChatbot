import{d as U,r as p,aa as $,B as V,a2 as w,e as z,a as i,w as _,g as r,b as m,c as f,j as b,i as E,f as d,n as h,t as x}from"./app-CSI2DTQR.js";import{s as T}from"./index-Bd5u6C13.js";import{s as A}from"./index-CIJ9kEDP.js";import{s as g}from"./index-DWx6GgBR.js";const D={class:"flex flex-col gap-6"},M={class:"grid grid-cols-12 gap-4"},j={class:"col-span-12"},F={key:0,class:"text-red-500"},G={key:1,class:"text-red-500"},L={class:"col-span-12"},R={key:0,class:"text-red-500"},S={class:"col-span-12"},W={key:0,class:"text-red-500"},q={key:1,class:"text-red-500"},P=U({__name:"UpdateAlerta",props:{visible:{type:Boolean},alertaId:{}},emits:["update:visible","updated"],setup(C,{emit:B}){const u=C,k=B,o=p(u.visible),c=p(!1),n=p(!1),t=p({}),a=p({titulo:"",descripcion:"",fecha:""}),v=$();V(()=>u.visible,l=>{o.value=l,l&&u.alertaId&&I()}),V(o,l=>k("update:visible",l));const I=async()=>{try{c.value=!0,t.value={};const l=await w.get(`/alerta/${u.alertaId}`);if(!l.data||!l.data.alert){v.add({severity:"error",summary:"Error",detail:"Alerta no encontrada",life:3e3});return}const e=l.data.alert;a.value={titulo:e.titulo??"",descripcion:e.descripcion??"",fecha:e.fecha??""}}catch(l){console.error(l),v.add({severity:"error",summary:"Error",detail:"No se pudo cargar la alerta",life:3e3})}finally{c.value=!1}},N=async()=>{var l,e;if(n.value=!0,t.value={},!(!a.value.titulo||!a.value.fecha))try{c.value=!0,await w.put(`/alerta/${u.alertaId}`,a.value),v.add({severity:"success",summary:"Actualizado",detail:"Alerta actualizada correctamente",life:3e3}),o.value=!1,k("updated")}catch(s){const y=s;((l=y.response)==null?void 0:l.status)===422&&((e=y.response.data)!=null&&e.errors)?(t.value=y.response.data.errors,v.add({severity:"error",summary:"Error de validación",detail:"Revisa los campos e intenta nuevamente",life:5e3})):v.add({severity:"error",summary:"Error",detail:"No se pudo actualizar la alerta",life:3e3}),console.error(s)}finally{c.value=!1}};return(l,e)=>(i(),z(d(T),{visible:o.value,"onUpdate:visible":e[4]||(e[4]=s=>o.value=s),header:"Editar Alerta",modal:!0,class:"w-full max-w-full sm:max-w-lg",style:{width:"95vw",maxWidth:"600px"}},{footer:_(()=>[m(d(A),{label:"Cancelar",icon:"pi pi-times",text:"",class:"mr-2",onClick:e[3]||(e[3]=s=>o.value=!1)}),m(d(A),{label:"Guardar",icon:"pi pi-check",loading:c.value,onClick:N},null,8,["loading"])]),default:_(()=>[r("div",D,[r("div",M,[r("div",j,[e[5]||(e[5]=r("label",{class:"block font-bold mb-2"},[E(" Título "),r("span",{class:"text-red-500"},"*")],-1)),m(d(g),{modelValue:a.value.titulo,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.titulo=s),modelModifiers:{trim:!0},placeholder:"Ingrese el título de la alerta",class:h(["w-full",{"p-invalid":n.value&&!a.value.titulo||t.value.titulo}])},null,8,["modelValue","class"]),n.value&&!a.value.titulo?(i(),f("small",F," El título es obligatorio. ")):b("",!0),t.value.titulo?(i(),f("small",G,x(t.value.titulo[0]),1)):b("",!0)]),r("div",L,[e[6]||(e[6]=r("label",{class:"block font-bold mb-2"},"Descripción",-1)),m(d(g),{modelValue:a.value.descripcion,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.descripcion=s),modelModifiers:{trim:!0},placeholder:"Ingrese la descripción de la alerta",class:h(["w-full",{"p-invalid":t.value.descripcion}])},null,8,["modelValue","class"]),t.value.descripcion?(i(),f("small",R,x(t.value.descripcion[0]),1)):b("",!0)]),r("div",S,[e[7]||(e[7]=r("label",{class:"block font-bold mb-2"},[E(" Fecha "),r("span",{class:"text-red-500"},"*")],-1)),m(d(g),{type:"date",modelValue:a.value.fecha,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.fecha=s),class:h(["w-full",{"p-invalid":n.value&&!a.value.fecha||t.value.fecha}])},null,8,["modelValue","class"]),n.value&&!a.value.fecha?(i(),f("small",W," La fecha es obligatoria. ")):b("",!0),t.value.fecha?(i(),f("small",q,x(t.value.fecha[0]),1)):b("",!0)])])])]),_:1},8,["visible"]))}});export{P as _};
