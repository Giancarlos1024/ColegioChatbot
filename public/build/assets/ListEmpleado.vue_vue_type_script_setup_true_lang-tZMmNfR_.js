import{s as b}from"./index-CIJ9kEDP.js";import{s as j,a as r}from"./index-8c4t-1rM.js";import{s as M,a as z,b as H}from"./index-CqE_d7Eh.js";import{s as G}from"./index-DWx6GgBR.js";import{s as K}from"./index-DTrYfW8t.js";import{s as q}from"./index-Bd5u6C13.js";import{d as J,aa as Q,r as s,B as $,o as W,c as h,a as y,F as X,b as a,f as l,w as d,j as C,g as u,a2 as Y}from"./app-CSI2DTQR.js";import{l as Z}from"./lodash-B3zt2wbW.js";import{_ as ee}from"./DeleteEmpleado.vue_vue_type_script_setup_true_lang-gufZD9a-.js";import{_ as ae}from"./UpdateEmpleado.vue_vue_type_script_setup_true_lang-_deen1_9.js";const le={class:"flex flex-wrap gap-2 items-center justify-between"},oe={class:"flex flex-wrap gap-2 w-full md:w-auto"},te=["src","onClick"],se={class:"flex flex-wrap gap-2"},re=["src"],we=J({__name:"ListEmpleado",props:{refresh:{}},setup(V){const D=Q(),I=s(null),E=s([]),P=s(null),m=s(!1),c=s(""),f=s(!1),k=s(null),_=s(null),p=s(null),v=s(!1),g=s(!1),w=s(""),L=V,F=s([{name:"TODOS",value:""},{name:"ACTIVOS",value:1},{name:"INACTIVOS",value:0}]),i=s({currentPage:1,perPage:15,total:0});function N(t){t&&(w.value=`/uploads/fotos/empleados/${t}`,g.value=!0)}function R(t){_.value=t.id,v.value=!0}function T(t){k.value=t,f.value=!0}function U(){n()}function A(){n()}const n=async()=>{var t;m.value=!0;try{const o={page:i.value.currentPage,per_page:i.value.perPage,search:c.value,state:((t=p.value)==null?void 0:t.value)??null},e=await Y.get("/empleado",{params:o});E.value=e.data.data,i.value.currentPage=e.data.meta.current_page,i.value.total=e.data.meta.total}catch(o){console.error(o),D.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los empleados",life:3e3})}finally{m.value=!1}},O=t=>{i.value.currentPage=t.page+1,i.value.perPage=t.rows,n()},S=t=>t?"success":"danger",B=Z.debounce(()=>{i.value.currentPage=1,n()},500);return $(()=>L.refresh,n),$(p,n),W(()=>{n()}),(t,o)=>(y(),h(X,null,[a(l(j),{ref_key:"dt",ref:I,selection:P.value,"onUpdate:selection":o[2]||(o[2]=e=>P.value=e),value:E.value,dataKey:"id",paginator:!0,rows:i.value.perPage,totalRecords:i.value.total,loading:m.value,lazy:!0,onPage:O,rowsPerPageOptions:[15,20,25],responsiveLayout:"scroll",scrollHeight:"auto",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} empleados"},{header:d(()=>[u("div",le,[o[7]||(o[7]=u("h4",{class:"m-0"},"EMPLEADOS",-1)),u("div",oe,[a(l(M),{class:"flex-1 md:flex-none"},{default:d(()=>[a(l(z),null,{default:d(()=>[...o[6]||(o[6]=[u("i",{class:"pi pi-search"},null,-1)])]),_:1}),a(l(G),{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=e=>c.value=e),onInput:l(B),placeholder:"Buscar...",class:"w-full"},null,8,["modelValue","onInput"])]),_:1}),a(l(H),{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=e=>p.value=e),options:F.value,optionLabel:"name",placeholder:"Estado",class:"w-full md:w-auto"},null,8,["modelValue","options"]),a(l(b),{title:"Refrescar",icon:"pi pi-refresh",outlined:"",rounded:"","aria-label":"Refresh",onClick:n})])])]),default:d(()=>[a(l(r),{selectionMode:"multiple",style:{width:"1rem"},exportable:!1}),a(l(r),{field:"name",header:"Nombre",sortable:"",style:{"min-width":"8rem"}}),a(l(r),{field:"apellido",header:"Apellido",sortable:"",style:{"min-width":"8rem"}}),a(l(r),{field:"codigo",header:"DNI",sortable:"",style:{"min-width":"6rem"}}),a(l(r),{field:"empleadoType",header:"Tipo de Empleado",sortable:"",style:{"min-width":"10rem"}}),a(l(r),{field:"idHuella",header:"ID Huella",sortable:"",style:{"min-width":"6rem"}}),a(l(r),{field:"creacion",header:"Creación",sortable:"",style:{"min-width":"10rem"}}),a(l(r),{field:"actualizacion",header:"Actualización",sortable:"",style:{"min-width":"10rem"}}),a(l(r),{field:"state",header:"Estado",sortable:"",style:{"min-width":"6rem"}},{body:d(({data:e})=>[a(l(K),{value:e.state?"Activo":"Inactivo",severity:S(e.state)},null,8,["value","severity"])]),_:1}),a(l(r),{field:"foto",header:"Foto",style:{"min-width":"6rem"}},{body:d(({data:e})=>[e.foto?(y(),h("img",{key:0,src:`/uploads/fotos/empleados/${e.foto}`,alt:"Foto",title:"Ver foto",class:"w-12 h-12 rounded-full object-cover cursor-pointer",onClick:x=>N(e.foto)},null,8,te)):C("",!0)]),_:1}),a(l(r),{field:"acciones",header:"Acciones",exportable:!1,style:{"min-width":"8rem"}},{body:d(e=>[u("div",se,[a(l(b),{title:"Editar empleado",icon:"pi pi-pencil",outlined:"",rounded:"",onClick:x=>R(e.data)},null,8,["onClick"]),a(l(b),{title:"Eliminar empleado",icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:x=>T(e.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["selection","value","rows","totalRecords","loading"]),a(ee,{visible:f.value,"onUpdate:visible":o[3]||(o[3]=e=>f.value=e),empleado:k.value,onDeleted:A},null,8,["visible","empleado"]),a(ae,{visible:v.value,"onUpdate:visible":o[4]||(o[4]=e=>v.value=e),empleadoId:_.value??0,onUpdated:U},null,8,["visible","empleadoId"]),a(l(q),{visible:g.value,"onUpdate:visible":o[5]||(o[5]=e=>g.value=e),modal:"",closable:!0,style:{width:"50vw"}},{default:d(()=>[w.value?(y(),h("img",{key:0,src:w.value,alt:"Foto Empleado",class:"w-full h-auto object-contain"},null,8,re)):C("",!0)]),_:1},8,["visible"])],64))}});export{we as _};
