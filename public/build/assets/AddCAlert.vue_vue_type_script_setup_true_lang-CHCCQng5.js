import{d as E,aa as N,r as d,c as n,a as u,F as j,b as l,f as i,w as f,g as s,j as p,i as x,t as _,a2 as w}from"./app-CSI2DTQR.js";import{s as T}from"./index-Bd5u6C13.js";import{s as B}from"./index-C_q0UAfk.js";import{s as g}from"./index-CIJ9kEDP.js";import{s as C}from"./index-DWx6GgBR.js";import D from"./toolsAlert-Bf-AfhIX.js";const S={class:"flex flex-col gap-6"},U={class:"grid grid-cols-12 gap-4"},$={class:"col-span-12 md:col-span-6"},F={key:0,class:"text-red-500"},R={key:1,class:"text-red-500"},G={class:"col-span-12 md:col-span-6"},L={key:0,class:"text-red-500"},W={key:1,class:"text-red-500"},q={class:"flex flex-col sm:flex-row gap-2 w-full sm:justify-end"},P=E({__name:"AddCAlert",emits:["config-alerta-agregada"],setup(z,{emit:k}){const v=N(),c=d(!1),m=d(!1),r=d({}),a=d({time:"",amount:""}),A=k;function b(){a.value={time:"",amount:""},r.value={},c.value=!1}async function h(){var o,e;b();try{const t=await w.get("/config_alerta/latest");t.data&&t.data.configAlert&&(a.value={time:((o=t.data.configAlert.time)==null?void 0:o.toString())||"",amount:((e=t.data.configAlert.amount)==null?void 0:e.toString())||""})}catch(t){console.error("Error al obtener última configuración:",t)}m.value=!0}function y(){m.value=!1,b()}async function V(){if(c.value=!0,r.value={},!(!a.value.time||!a.value.amount))try{const o={time:Number(a.value.time),amount:Number(a.value.amount)};await w.post("/config_alerta",o),v.add({severity:"success",summary:"Éxito",detail:"Configuración de alerta registrada",life:3e3}),y(),A("config-alerta-agregada")}catch(o){const e=o;e.response&&e.response.status===422?(r.value=e.response.data.errors||{},v.add({severity:"error",summary:"Error de validación",detail:"Revisa los campos e intenta nuevamente.",life:5e3})):v.add({severity:"error",summary:"Error",detail:"No se pudo registrar la configuración de alerta",life:3e3}),console.error(o)}}return(o,e)=>(u(),n(j,null,[l(i(B),{class:"mb-6"},{start:f(()=>[l(i(g),{label:"Configurar Alerta",icon:"pi pi-cog",severity:"secondary",class:"mr-2",onClick:h})]),end:f(()=>[l(D)]),_:1}),l(i(T),{visible:m.value,"onUpdate:visible":e[2]||(e[2]=t=>m.value=t),style:{width:"95vw",maxWidth:"600px"},header:"Registro de Configuración de Alerta",modal:!0},{footer:f(()=>[s("div",q,[l(i(g),{label:"Cancelar",icon:"pi pi-times",text:"",onClick:y,class:"w-full sm:w-auto"}),l(i(g),{label:"Guardar",icon:"pi pi-check",onClick:V,class:"w-full sm:w-auto"})])]),default:f(()=>[s("div",S,[s("div",U,[s("div",$,[e[3]||(e[3]=s("label",{class:"block font-bold mb-3"},[x("Cantidad "),s("span",{class:"text-red-500"},"*")],-1)),l(i(C),{modelValue:a.value.amount,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.amount=t),type:"number",step:"1",min:"0",placeholder:"Ej. 1000",class:"w-full"},null,8,["modelValue"]),c.value&&!a.value.amount?(u(),n("small",F,"La cantidad es obligatoria.")):p("",!0),r.value.amount?(u(),n("small",R,_(r.value.amount[0]),1)):p("",!0)]),s("div",G,[e[4]||(e[4]=s("label",{class:"block font-bold mb-3"},[x("Tiempo "),s("span",{class:"text-red-500"},"*")],-1)),l(i(C),{modelValue:a.value.time,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.time=t),type:"number",step:"0.01",min:"0",placeholder:"Ej. 5.5",class:"w-full"},null,8,["modelValue"]),c.value&&!a.value.time?(u(),n("small",L,"El tiempo es obligatorio.")):p("",!0),r.value.time?(u(),n("small",W,_(r.value.time[0]),1)):p("",!0)])])])]),_:1},8,["visible"])],64))}});export{P as _};
