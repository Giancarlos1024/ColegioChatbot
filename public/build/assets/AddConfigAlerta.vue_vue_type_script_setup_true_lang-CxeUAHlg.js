import{d as N,aa as A,r as c,c as n,a as u,F as E,b as l,f as o,w as v,g as t,j as f,i as y,t as _,a2 as j}from"./app-CSI2DTQR.js";import{s as T}from"./index-Bd5u6C13.js";import{s as B}from"./index-C_q0UAfk.js";import{s as g}from"./index-CIJ9kEDP.js";import{s as w}from"./index-DWx6GgBR.js";import D from"./toolsConfigAlert-BKykDQjR.js";const U={class:"flex flex-col gap-6"},$={class:"grid grid-cols-12 gap-4"},F={class:"col-span-12 md:col-span-6"},R={key:0,class:"text-red-500"},G={key:1,class:"text-red-500"},L={class:"col-span-12 md:col-span-6"},S={key:0,class:"text-red-500"},W={key:1,class:"text-red-500"},q={class:"flex flex-col sm:flex-row gap-2 w-full sm:justify-end"},P=N({__name:"AddConfigAlerta",emits:["config-alerta-agregada"],setup(z,{emit:C}){const p=A(),m=c(!1),d=c(!1),s=c({}),e=c({time:"",amount:""}),k=C;function b(){e.value={time:"",amount:""},s.value={},m.value=!1}function V(){b(),d.value=!0}function x(){d.value=!1,b()}async function h(){if(m.value=!0,s.value={},!(e.value.time===""||e.value.time===null||e.value.time===void 0)&&!(e.value.amount===""||e.value.amount===null||e.value.amount===void 0))try{const r={time:Number(e.value.time),amount:Number(e.value.amount)};await j.post("/config_alerta",r),p.add({severity:"success",summary:"Éxito",detail:"Configuración de alerta registrada",life:3e3}),x(),k("config-alerta-agregada")}catch(r){const a=r;a.response&&a.response.status===422?(s.value=a.response.data.errors||{},p.add({severity:"error",summary:"Error de validación",detail:"Revisa los campos e intenta nuevamente.",life:5e3})):p.add({severity:"error",summary:"Error",detail:"No se pudo registrar la configuración de alerta",life:3e3}),console.error(r)}}return(r,a)=>(u(),n(E,null,[l(o(B),{class:"mb-6"},{start:v(()=>[l(o(g),{label:"Nueva configuración",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:V})]),end:v(()=>[l(D)]),_:1}),l(o(T),{visible:d.value,"onUpdate:visible":a[2]||(a[2]=i=>d.value=i),style:{width:"95vw",maxWidth:"600px"},header:"Registro de Configuración de Alerta",modal:!0},{footer:v(()=>[t("div",q,[l(o(g),{label:"Cancelar",icon:"pi pi-times",text:"",onClick:x,class:"w-full sm:w-auto"}),l(o(g),{label:"Guardar",icon:"pi pi-check",onClick:h,class:"w-full sm:w-auto"})])]),default:v(()=>[t("div",U,[t("div",$,[t("div",F,[a[3]||(a[3]=t("label",{class:"block font-bold mb-3"},[y("Cantidad "),t("span",{class:"text-red-500"},"*")],-1)),l(o(w),{modelValue:e.value.amount,"onUpdate:modelValue":a[0]||(a[0]=i=>e.value.amount=i),type:"number",step:"1",min:"0",placeholder:"Ej. 1000",class:"w-full"},null,8,["modelValue"]),m.value&&(e.value.amount===""||e.value.amount===null||e.value.amount===void 0)?(u(),n("small",R,"La cantidad es obligatoria.")):f("",!0),s.value.amount?(u(),n("small",G,_(s.value.amount[0]),1)):f("",!0)]),t("div",L,[a[4]||(a[4]=t("label",{class:"block font-bold mb-3"},[y("Tiempo "),t("span",{class:"text-red-500"},"*")],-1)),l(o(w),{modelValue:e.value.time,"onUpdate:modelValue":a[1]||(a[1]=i=>e.value.time=i),type:"number",step:"0.01",min:"0",placeholder:"Ej. 5.5",class:"w-full"},null,8,["modelValue"]),m.value&&(e.value.time===""||e.value.time===null||e.value.time===void 0)?(u(),n("small",S,"El tiempo es obligatorio.")):f("",!0),s.value.time?(u(),n("small",W,_(s.value.time[0]),1)):f("",!0)])])])]),_:1},8,["visible"])],64))}});export{P as _};
