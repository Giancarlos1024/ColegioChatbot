import{s as _}from"./index-Bd5u6C13.js";import{s as E}from"./index-CIJ9kEDP.js";import{s as N,a as s}from"./index-8c4t-1rM.js";import{s as m}from"./index-DTrYfW8t.js";import{d as k,r as v,aa as C,B as y,a2 as B,e as R,a as d,w as r,c as u,g as h,b as o,j as M,f as t}from"./app-CSI2DTQR.js";import"./index-CqE_d7Eh.js";import"./index-DWx6GgBR.js";import"./index-D_KOsQEr.js";import"./index-BwbBMxE1.js";import"./index-C4jvCa1H.js";import"./index-z3Yo8sjz.js";import"./index-BsSS1dRr.js";import"./index-OH50f74-.js";const V={key:0,class:"text-center p-4"},$={key:1},A={key:0,class:"text-center text-gray-500 mt-4"},G=k({__name:"ViewAlerta",props:{visible:{type:Boolean},idMovimientos:{}},emits:["update:visible"],setup(w,{emit:b}){const n=w,x=b,l=v(n.visible),p=v(!1),c=v([]),f=C();y(()=>n.visible,async a=>{var i;l.value=a,a&&((i=n.idMovimientos)==null?void 0:i.length)>0&&await g(n.idMovimientos)}),y(l,a=>x("update:visible",a));async function g(a){try{p.value=!0,c.value=[];const i=await B.get("/movimiento",{params:{per_page:100}});if(!i.data||!i.data.data){f.add({severity:"warn",summary:"Aviso",detail:"No se encontraron movimientos",life:3e3});return}c.value=i.data.data.filter(e=>a.includes(e.id)).map(e=>({...e,tipoDescripcion:e.tipoDescripcion||(e.idTipo===1?"Cara":"Huella")}))}catch(i){f.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los movimientos",life:3e3}),console.error(i)}finally{p.value=!1}}return(a,i)=>(d(),R(t(_),{visible:l.value,"onUpdate:visible":i[1]||(i[1]=e=>l.value=e),header:"Movimientos de la Alerta",modal:!0,class:"w-full max-w-full sm:max-w-3xl",style:{width:"95vw",maxWidth:"800px"}},{footer:r(()=>[o(t(E),{label:"Cerrar",icon:"pi pi-times",text:"",onClick:i[0]||(i[0]=e=>l.value=!1)})]),default:r(()=>[p.value?(d(),u("div",V,[...i[2]||(i[2]=[h("i",{class:"pi pi-spin pi-spinner text-2xl"},null,-1),h("p",null,"Cargando movimientos...",-1)])])):(d(),u("div",$,[o(t(N),{value:c.value,class:"p-datatable-sm",responsiveLayout:"scroll",stripedRows:""},{default:r(()=>[o(t(s),{field:"id",header:"ID",style:{width:"5%"}}),o(t(s),{field:"Espacio",header:"Espacio",style:{width:"20%"}}),o(t(s),{header:"Tipo",style:{width:"10%"}},{body:r(({data:e})=>[o(t(m),{value:e.tipoDescripcion,severity:e.idTipo===1?"info":"warning"},null,8,["value","severity"])]),_:1}),o(t(s),{field:"reconocido",header:"Reconocido",style:{width:"10%"}},{body:r(({data:e})=>[o(t(m),{value:e.reconocido?"Sí":"No",severity:e.reconocido?"success":"danger"},null,8,["value","severity"])]),_:1}),o(t(s),{field:"access",header:"Acceso",style:{width:"10%"}},{body:r(({data:e})=>[o(t(m),{value:e.access?"Sí":"No",severity:e.access?"success":"danger"},null,8,["value","severity"])]),_:1}),o(t(s),{field:"error",header:"Error",style:{width:"10%"}}),o(t(s),{field:"fechaEnvioESP32",header:"Envío ESP32",style:{width:"15%"}}),o(t(s),{field:"fechaRecepcion",header:"Recepción",style:{width:"15%"}}),o(t(s),{field:"fechaReconocimiento",header:"Reconocimiento",style:{width:"15%"}})]),_:1},8,["value"]),c.value.length===0?(d(),u("div",A," No se encontraron movimientos relacionados con esta alerta. ")):M("",!0)]))]),_:1},8,["visible"]))}});export{G as default};
