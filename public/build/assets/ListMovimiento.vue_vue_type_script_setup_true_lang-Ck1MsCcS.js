import{s as y}from"./index-CIJ9kEDP.js";import{s as G,a as s}from"./index-8c4t-1rM.js";import{s as K}from"./index-DWx6GgBR.js";import{s as q,a as J,b as h}from"./index-CqE_d7Eh.js";import{s as P}from"./index-DTrYfW8t.js";import{d as Q,aa as W,r as t,B as k,a2 as X,o as Y,c as Z,a as ee,F as oe,b as o,f as a,w as n,i as C,t as E,g as v}from"./app-CSI2DTQR.js";import{l as ae}from"./lodash-B3zt2wbW.js";import{_ as le}from"./DeleteMovimiento.vue_vue_type_script_setup_true_lang-BJPg4tw8.js";import{_ as te}from"./UpdateMovimiento.vue_vue_type_script_setup_true_lang-DShqnZn1.js";const ie={class:"flex flex-col md:flex-row flex-wrap gap-2 items-start md:items-center justify-between"},se={class:"flex flex-col md:flex-row flex-wrap gap-2 w-full md:w-auto"},ge=Q({__name:"ListMovimiento",props:{refresh:{}},setup(O){const S=O,D=W(),_=t(null),x=t([]),V=t([]),f=t(!1),g=t(""),w=t(!1),b=t(!1),M=t(null),T=t(null),c=t(null),m=t(null),p=t(null),$=t(1),r=t({currentPage:1,perPage:15,total:0}),L=t([{name:"TODOS",value:""},{name:"Cara",value:1},{name:"Huella",value:2}]),N=t([{name:"TODOS",value:""},{name:"Reconocido",value:1},{name:"No Reconocido",value:0}]),U=t([{name:"TODOS",value:""},{name:"Con Acceso",value:1},{name:"Sin Acceso",value:0}]),A=i=>{switch(i){case 1:return"Cara";case 2:return"Huella";default:return"Desconocido"}};k(()=>S.refresh,()=>{u()}),k([c,p,m],()=>{$.value=1,u()});function I(i){T.value=i.id,b.value=!0}function B(i){M.value=i,w.value=!0}function F(){u()}function z(){u()}const u=async()=>{var i,l;f.value=!0;try{const e={page:r.value.currentPage,per_page:r.value.perPage,search:g.value,idTipo:m.value??"",reconocido:((i=c.value)==null?void 0:i.value)??"",access:((l=p.value)==null?void 0:l.value)??""},d=await X.get("/movimiento",{params:e});x.value=d.data.data,r.value.currentPage=d.data.meta.current_page,r.value.total=d.data.meta.total}catch(e){console.error("Error al cargar movimientos:",e),D.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los movimientos",life:3e3})}finally{f.value=!1}},H=i=>{r.value.currentPage=i.page+1,r.value.perPage=i.rows,u()},j=ae.debounce(()=>{r.value.currentPage=1,u()},500),R=i=>i?"success":"danger";return Y(()=>{u()}),(i,l)=>(ee(),Z(oe,null,[o(a(G),{ref_key:"dt",ref:_,selection:V.value,"onUpdate:selection":l[4]||(l[4]=e=>V.value=e),value:x.value,dataKey:"id",paginator:!0,rows:r.value.perPage,totalRecords:r.value.total,loading:f.value,lazy:!0,onPage:H,rowsPerPageOptions:[15,20,25],scrollable:"",scrollHeight:"574px",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} movimientos",class:"w-full"},{header:n(()=>[v("div",ie,[l[8]||(l[8]=v("h4",{class:"m-0"},"MOVIMIENTOS",-1)),v("div",se,[o(a(q),{class:"w-full md:w-auto"},{default:n(()=>[o(a(J),null,{default:n(()=>[...l[7]||(l[7]=[v("i",{class:"pi pi-search"},null,-1)])]),_:1}),o(a(K),{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=e=>g.value=e),onInput:a(j),placeholder:"Buscar por espacio",class:"w-full md:w-80"},null,8,["modelValue","onInput"])]),_:1}),o(a(h),{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=e=>m.value=e),options:L.value,optionLabel:"name",optionValue:"value",placeholder:"Tipo",class:"w-full md:w-auto"},null,8,["modelValue","options"]),o(a(h),{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value=e),options:N.value,optionLabel:"name",placeholder:"Reconocido",class:"w-full md:w-auto"},null,8,["modelValue","options"]),o(a(h),{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=e=>p.value=e),options:U.value,optionLabel:"name",placeholder:"Acceso",class:"w-full md:w-auto"},null,8,["modelValue","options"]),o(a(y),{icon:"pi pi-refresh",outlined:"",rounded:"",class:"w-full md:w-auto",onClick:u})])])]),default:n(()=>[o(a(s),{selectionMode:"multiple",style:{width:"1rem"}}),o(a(s),{field:"Espacio",header:"Espacio",sortable:"",style:{"min-width":"12rem"}}),o(a(s),{field:"idTipo",header:"Tipo",sortable:"",style:{"min-width":"10rem"}},{body:n(({data:e})=>[o(a(P),{value:A(e.idTipo),severity:e.idTipo===1?"info":"warning"},null,8,["value","severity"])]),_:1}),o(a(s),{field:"reconocido",header:"Reconocido",sortable:"",style:{"min-width":"8rem"}},{body:n(({data:e})=>[o(a(P),{value:e.reconocido?"Sí":"No",severity:R(e.reconocido)},null,8,["value","severity"])]),_:1}),o(a(s),{field:"access",header:"Acceso",sortable:"",style:{"min-width":"8rem"}},{body:n(({data:e})=>[o(a(P),{value:e.access?"Sí":"No",severity:R(e.access)},null,8,["value","severity"])]),_:1}),o(a(s),{field:"error",header:"Error",sortable:"",style:{"min-width":"6rem"}},{body:n(({data:e})=>[C(E(e.error&&e.error!=0?e.error:"Ninguno"),1)]),_:1}),o(a(s),{field:"persona",header:"Persona",sortable:"",style:{"min-width":"12rem"}},{body:n(({data:e})=>[C(E(e.persona??"---"),1)]),_:1}),o(a(s),{field:"fechaEnvioESP32",header:"Envío ESP32",sortable:"",style:{"min-width":"13rem"}}),o(a(s),{field:"fechaRecepcion",header:"Recepción",sortable:"",style:{"min-width":"13rem"}}),o(a(s),{field:"fechaReconocimiento",header:"Reconocimiento",sortable:"",style:{"min-width":"13rem"}}),o(a(s),{field:"creacion",header:"Creación",sortable:"",style:{"min-width":"13rem"}}),o(a(s),{field:"actualizacion",header:"Actualización",sortable:"",style:{"min-width":"13rem"}}),o(a(s),{field:"acciones",header:"Acciones",exportable:!1,style:{"min-width":"8rem"}},{body:n(({data:e})=>[o(a(y),{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2 mb-2 md:mb-0",onClick:d=>I(e)},null,8,["onClick"]),o(a(y),{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",class:"mb-2 md:mb-0",onClick:d=>B(e)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","rows","totalRecords","loading"]),o(le,{visible:w.value,"onUpdate:visible":l[5]||(l[5]=e=>w.value=e),movimiento:M.value,onDeleted:F},null,8,["visible","movimiento"]),o(te,{visible:b.value,"onUpdate:visible":l[6]||(l[6]=e=>b.value=e),movimientoId:T.value,onUpdated:z},null,8,["visible","movimientoId"])],64))}});export{ge as _};
